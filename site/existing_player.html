<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Mémory : Version d'essai, joueur existant</title>

    <script type="application/javascript" src="script/Data_management.js"></script>
    <style>
        table
        {
            border-collapse: collapse; /* Les bordures du tableau seront collées (plus joli) */
        }

        td,th /* Toutes les cellules des tableaux... */
        {
            border: 1px solid black; /* auront une bordure de 1px */
        }
    </style>
</head>
<body onload="init();">

<table id="tablePlayers">
    <tr>
        <th>Prénom</th>
        <th>Nom</th>
        <th>Date de Naissance</th>
        <th>Age</th>
        <th>Classe</th>
        <th>Sexe</th>
        <th>Version</th>
        <th>Date de partie</th>
        <th>Choisir</th>
    </tr>
</table>

<script type="text/javascript">

    var arrayGame;

    arrayGame = load_data("arrayGame");

    function init()
    {
        var compte;
        var i;
        var newRow;
        var newCell;
        var button;
        /*
         **  rajoute une ligne au tableau par compte avec toute les info du compte.
         */
        for (i = 0; i < arrayGame.length; i++)
        {
            compte = arrayGame[i];
            newRow = document.getElementById('tablePlayers').insertRow(-1);
            newCell = newRow.insertCell(0);
            newCell.innerHTML = compte.firstname;
            newCell = newRow.insertCell(1);
            newCell.innerHTML = compte.name;
            newCell = newRow.insertCell(2);
            newCell.innerHTML = compte.birthdate;
            newCell = newRow.insertCell(3);
            newCell.innerHTML = compte.age;
            newCell = newRow.insertCell(4);
            newCell.innerHTML = compte.classe;
            newCell = newRow.insertCell(5);
            newCell.innerHTML = compte.sex;
            newCell = newRow.insertCell(6);
            newCell.innerHTML = compte.version;
            newCell = newRow.insertCell(7);
            newCell.innerHTML = compte.date;
            newCell = newRow.insertCell(8);
            //newCell.innerHTML = '<a href="NewPlayer.html?id=' + i + '">button</a>';     /*surement mieux à faire, trouver un motyen de detecter de quelle page on vient sur New player*/
            newCell.innerHTML = '<input type="submit" id="' + i + '" name="creategame" value="Button"/>';
        }
        button = document.getElementsByName("creategame");
        for (i = 0; i < button.length; i++)
        {
            button[i].onclick = creategame
        }
    }

    function creategame(mouseEvent)
    {
        var     index;
        var     newindex;
        var     select;
        var     config;
        var     now;
        var     val;

        now = new Date();
        config = load_data("config");
        select = mouseEvent.target;
        index = select.id;
        newindex = arrayGame.length;
        arrayGame[arrayGame.length] = newGame();
        alert("debug_" + arrayGame[newindex].firstname);
        arrayGame[newindex].firstname = arrayGame[index].firstname;
        alert("debug_");
        arrayGame[newindex].name = arrayGame[index].name;
        arrayGame[newindex].birthdate = arrayGame[index].birthdate;
        arrayGame[newindex].age = arrayGame[index].age;
        arrayGame[newindex].classe = arrayGame[index].classe;
        arrayGame[newindex].sex = arrayGame[index].sex;
        arrayGame[newindex].preGameVisibilityDuration = config.counter;
        arrayGame[newindex].gameLimit = config.time;
        arrayGame[newindex].date = now.getFullYear() + "-" + ('0'+(now.getMonth()+1)).slice(-2) + "-" + ('0'+now.getDate()).slice(-2);
        if (arrayGame[index].version === "humors")
            arrayGame[newindex].version = "sad";
        else
            arrayGame[newindex].version = "humors";
        val = JSON.stringify(arrayGame);
        window.localStorage.setItem("arrayGame", val);
        location.href=("Rules.html");
    }

    /*document.getElementsByName('creategame').onclick = function() {                     //à verifier pas sur que cela marche
        arrayGame[arrayGame.length] = newGame();
        arrayGame[arrayGame.length].firstname = arrayGame[].firstname;
        arrayGame[arrayGame.length].name = arrayGame[arrayGame.length - 1].name;
        arrayGame[arrayGame.length].birthdate = arrayGame[arrayGame.length - 1].birthdate;
        arrayGame[arrayGame.length]. = arrayGame[arrayGame.length - 1].;
        arrayGame[arrayGame.length]. = arrayGame[arrayGame.length - 1].;
        arrayGame[arrayGame.length]. = arrayGame[arrayGame.length - 1].;
        arrayGame[arrayGame.length]. = arrayGame[arrayGame.length - 1].;
        arrayGame[arrayGame.length]. = arrayGame[arrayGame.length - 1].;
    }*/
</script>

</body>
</html>